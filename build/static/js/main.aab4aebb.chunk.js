(this["webpackJsonpmeu-formulario"]=this["webpackJsonpmeu-formulario"]||[]).push([[0],{19:function(e,t,n){},26:function(e,t,n){e.exports=n(37)},31:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(17),o=n(24),i=n(0),s=n.n(i),r=n(21),l=n.n(r),c=(n(19),n(2)),u=n(3),d=n(1),m=n(5),p=n(4),h=n(25),v=(n(31),function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).onLogin=a.onLogin.bind(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"onLogin",value:function(e){var t=new XMLHttpRequest;t.addEventListener("load",(function(){var e=JSON.parse(t.responseText).url;window.location.replace(e)})),t.open("GET","https://api-meu-formulario.herokuapp.com/login"),t.send()}},{key:"render",value:function(){return s.a.createElement("div",{id:"login"},s.a.createElement("button",{type:"button",onClick:this.onLogin},"Entrar com Trello"))}}]),n}(i.Component)),f=n(9),b={user:null},E=s.a.createContext(b),g=s.a.createContext(void 0),C=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={itemSelected:null,forms:[]},a.onSelect=a.onSelect.bind(Object(d.a)(a)),a.onEditPath=a.onEditPath.bind(Object(d.a)(a)),a.onEmptySelection=a.onEmptySelection.bind(Object(d.a)(a)),a.onRemove=a.onRemove.bind(Object(d.a)(a)),a.loadForms=a.loadForms.bind(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.loadForms()}},{key:"onSelect",value:function(e){this.setState({itemSelected:e.target.id})}},{key:"onRemove",value:function(e){var t=this;this.onEmptySelection();var n=this.state.itemSelected,a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState)if(204===a.status){alert("Removido com sucesso!");var e=[];t.state.forms.map((function(t){t.id!=n&&e.push(t)})),t.setState({forms:e})}else alert("Falha em remover!")},a.open("delete","https://api-meu-formulario.herokuapp.com/users/"+this.context.user.id+"/forms/"+n),a.setRequestHeader("Authorization",this.context.user.lastToken),a.send()}},{key:"onEditPath",value:function(e){return this.state.itemSelected?"/formulario/"+this.state.itemSelected:"/formularios"}},{key:"onEmptySelection",value:function(){this.state.itemSelected||alert("Selecione um item para realizar esta a\xe7\xe3o.")}},{key:"loadForms",value:function(){var e=this,t=new XMLHttpRequest;t.addEventListener("load",(function(){var n=JSON.parse(t.responseText);e.setState({forms:n})})),t.open("get","https://api-meu-formulario.herokuapp.com/users/"+this.context.user.id+"/forms"),t.setRequestHeader("Authorization",this.context.user.lastToken),t.send()}},{key:"componentDidUpdate",value:function(){console.log(this.state)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"container"},s.a.createElement("div",null,s.a.createElement("div",{className:"menu-table"},s.a.createElement("div",{className:"table-button"},s.a.createElement(f.b,{to:"/formulario"},s.a.createElement("button",null,"Criar"))),s.a.createElement("div",{className:"table-button"},s.a.createElement(f.b,{onClick:this.onRemove,to:"/formularios"},s.a.createElement("button",null,"Remover"))),s.a.createElement("div",{className:"table-button"},s.a.createElement("button",{onClick:this.loadForms},"Atualizar"))),s.a.createElement("div",{className:"table-search"},s.a.createElement("input",{type:"text"}))),s.a.createElement("div",{className:"table-div"},s.a.createElement("table",null,s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,"T\xedtulo:"),s.a.createElement("th",null,"Link:"),s.a.createElement("th",null,"Selecionar"))),s.a.createElement("tbody",null,this.state.forms.map((function(t,n){return s.a.createElement("tr",{key:n},s.a.createElement("td",null,t.title),s.a.createElement("td",null,s.a.createElement(f.b,{to:"/formulario/"+t.link+"/responder"},t.link)),s.a.createElement("td",null,s.a.createElement("input",{onChange:e.onSelect,type:"radio",name:"select",id:t.id})))}))))))}}]),n}(i.Component);C.contextType=E;var y=C,k=n(11),O=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={token:document.URL.split("#")[1].split("=")[1],isUserLogged:!1},a.loadUser=a.loadUser.bind(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.loadUser()}},{key:"loadUser",value:function(){var e=this,t=new XMLHttpRequest;t.addEventListener("load",(function(){var n=JSON.parse(t.responseText);e.context({user:n}),e.setState({isUserLogged:!0}),console.log("sucesso!")})),t.open("get","https://api-meu-formulario.herokuapp.com/logged"),t.setRequestHeader("Authorization",this.state.token),t.send()}},{key:"render",value:function(){return this.state.isUserLogged?s.a.createElement(k.a,{to:"/formularios"}):s.a.createElement("div",null)}}]),n}(i.Component);O.contextType=g;var j=O,S=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).onChange=a.onChange.bind(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"onChange",value:function(e){"file"!==this.props.component.type?this.props.onChangeComponent(this.props.component.id,e.target.value):this.props.onChangeComponent(this.props.component.id,e.target.files[0])}},{key:"componentWillReceiveProps",value:function(e){document.getElementById("component"+this.props.component.id).value=e.component.data}},{key:"render",value:function(){return"textarea"===this.props.component.type?s.a.createElement("div",{"data-id":this.props.component.id},s.a.createElement("textarea",{id:"component"+this.props.component.id,"data-id":this.props.component.id,onChange:this.onChange})):"date"===this.props.component.type||"file"===this.props.component.type?s.a.createElement("div",null,s.a.createElement("input",{id:"component"+this.props.component.id,className:"input-text","data-id":this.props.component.id,type:this.props.component.type,onChange:this.onChange,accept:"image/*"})):s.a.createElement("div",{"data-id":this.props.component.id},s.a.createElement("div",{className:"div-left"},s.a.createElement("input",{"data-id":this.props.component.id,type:this.props.component.type,name:"question"+this.props.idQuestion})),s.a.createElement("div",{className:"div-right"},s.a.createElement("input",{id:"component"+this.props.component.id,className:"input-text",type:"text",onChange:this.onChange})))}}]),n}(i.Component),q=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).onChangeQuestion=a.onChangeQuestion.bind(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"onChangeQuestion",value:function(e){this.props.onChangeQuestion(this.props.question.id,e.target.value)}},{key:"componentDidUpdate",value:function(){console.log("questao",this.props.question)}},{key:"componentWillReceiveProps",value:function(e){document.getElementById("question"+this.props.id).value=e.question.title}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{id:this.props.id,className:"auto-generated"},s.a.createElement("div",{className:"div-left"},s.a.createElement("input",{onClick:this.props.onSelect,"data-id":this.props.id,type:"radio",name:"selected"})),s.a.createElement("div",{className:"div-right"},s.a.createElement("div",{className:"question-text-div"},s.a.createElement("label",{className:"question-label",htmlFor:"question"+this.props.id},"Quest\xe3o ",1+this.props.index),s.a.createElement("input",{className:"input-text",id:"question"+this.props.id,type:"text",onChange:this.onChangeQuestion})),s.a.createElement("div",null,this.props.question.components.map((function(t,n){return s.a.createElement("div",{className:"question-component-div",key:n},s.a.createElement(S,{component:t,idQuestion:e.props.question.id,onChangeComponent:e.props.onChangeComponent}))})))))}}]),n}(i.Component),L=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={title:"",questions:[],questionsId:0,componentsId:0,selected:null,selectedBoard:null,selectedList:null,boards:[],lists:[]},a.onAddQuestion=a.onAddQuestion.bind(Object(d.a)(a)),a.onAddComponent=a.onAddComponent.bind(Object(d.a)(a)),a.onRemoveQuestion=a.onRemoveQuestion.bind(Object(d.a)(a)),a.onSelect=a.onSelect.bind(Object(d.a)(a)),a.onSelectBoard=a.onSelectBoard.bind(Object(d.a)(a)),a.onSelectList=a.onSelectList.bind(Object(d.a)(a)),a.onChangeQuestion=a.onChangeQuestion.bind(Object(d.a)(a)),a.onChangeComponent=a.onChangeComponent.bind(Object(d.a)(a)),a.onChangeTitle=a.onChangeTitle.bind(Object(d.a)(a)),a.onSave=a.onSave.bind(Object(d.a)(a)),a.loadBoards=a.loadBoards.bind(Object(d.a)(a)),a.loadLists=a.loadLists.bind(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"onSelectBoard",value:function(e){var t=null,n=e.target;this.state.boards.map((function(e){e.id===n.options[n.selectedIndex].getAttribute("data-id")&&(t=e)})),this.setState({selectedBoard:t})}},{key:"onSelectList",value:function(e){var t=null,n=e.target;this.state.lists.map((function(e){e.id===n.options[n.selectedIndex].getAttribute("data-id")&&(t=e)})),this.setState({selectedList:t})}},{key:"loadBoards",value:function(){var e=this,t=new XMLHttpRequest;t.addEventListener("load",(function(){var n=JSON.parse(t.responseText);e.setState({boards:n,selectedBoard:n[0]}),e.loadLists()})),t.open("get","https://api-meu-formulario.herokuapp.com/trello/boards"),t.setRequestHeader("Authorization",this.context.user.lastToken),t.send()}},{key:"loadLists",value:function(){var e=this;if(!this.state.selectedBoard)return 1;var t=new XMLHttpRequest;t.addEventListener("load",(function(){var n=JSON.parse(t.responseText);e.setState({lists:n,selectedList:n[0]})})),t.open("get","https://api-meu-formulario.herokuapp.com/trello/boards/"+this.state.selectedBoard.id+"/lists"),t.setRequestHeader("Authorization",this.context.user.lastToken),t.send()}},{key:"onSave",value:function(){var e={title:this.state.title,idList:this.state.selectedList.id,questions:this.state.questions};console.log(e);var t=new XMLHttpRequest;t.onreadystatechange=function(){4===t.readyState&&(201!==t.status?alert("Houve um erro!"):alert("Salvo com sucesso!"))},t.open("post","https://api-meu-formulario.herokuapp.com/users/"+this.context.user.id+"/forms"),t.setRequestHeader("Authorization",this.context.user.lastToken),t.setRequestHeader("Content-Type","application/json"),t.send(JSON.stringify(e))}},{key:"onChangeTitle",value:function(e){this.setState({title:e.target.value})}},{key:"onSelect",value:function(e){this.setState({selected:e.target.getAttribute("data-id")})}},{key:"onAddQuestion",value:function(){this.state.questions.push({id:this.state.questionsId,title:"",components:[]}),this.setState({questionsId:this.state.questionsId+1})}},{key:"onAddComponent",value:function(e,t){var n=this;this.state.selected?(this.state.questions.map((function(e){e.id==n.state.selected&&e.components.push({id:n.state.componentsId,type:t,data:""})})),this.setState({componentsId:this.state.componentsId+1})):alert("Primeiro selecione uma pergunta")}},{key:"onRemoveQuestion",value:function(e){var t=this;if(this.state.selected){var n=[],a=null;console.log(this.state.selected),this.state.questions.map((function(e,o){e.id!=t.state.selected?n.push(e):t.state.questions[o+1]&&(a=t.state.questions[o+1].id)})),this.setState({questions:n,selected:a})}else alert("Primeiro selecione uma pergunta")}},{key:"onChangeComponent",value:function(e,t){this.state.questions.map((function(n){n.components.map((function(n){n.id==e&&(n.data=t)}))}))}},{key:"onChangeQuestion",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.state.questions.map((function(n){n.id==e&&(n.title=t)}))}},{key:"componentDidMount",value:function(){this.loadBoards()}},{key:"componentDidUpdate",value:function(){this.state.selectedList&&this.state.selectedList.idBoard!=this.state.selectedBoard.id&&(console.log("Atualizando",this.state.selectedList,this.state.selectedBoard.id),this.loadLists())}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("div",{className:"menu-form"},s.a.createElement("div",null,s.a.createElement("h3",null,"Menu")),s.a.createElement("hr",null),s.a.createElement("div",null,s.a.createElement("h3",null,"Selecione o quadro do trelo desejado:"),s.a.createElement("select",{onChange:this.onSelectBoard},this.state.boards.map((function(e,t){return s.a.createElement("option",{key:t,"data-id":e.id},e.name)})))),this.state.selectedBoard?s.a.createElement("div",null,s.a.createElement("h3",null,"Selecione a lista do quadro:"),s.a.createElement("select",{onChange:this.onSelectList},this.state.lists.map((function(e,t){return s.a.createElement("option",{key:t,"data-id":e.id},e.name)})))):null,s.a.createElement("div",{className:"menu-div-buttons"},s.a.createElement("div",null,s.a.createElement("button",{onClick:this.onAddQuestion},"Adicionar cart\xe3o pergunta"),s.a.createElement("button",{onClick:this.onRemoveQuestion},"Remover cart\xe3o pergunta"),s.a.createElement("button",{onClick:function(t){e.onAddComponent(t,"textarea")}},"Adicionar textarea")),s.a.createElement("div",null,s.a.createElement("button",{onClick:function(t){e.onAddComponent(t,"checkbox")}},"Adicionar checkbox"),s.a.createElement("button",{onClick:function(t){e.onAddComponent(t,"radio")}},"Adicionar radiobox"),s.a.createElement("button",{onClick:function(t){e.onAddComponent(t,"date")}},"Adicionar campo data")),s.a.createElement("div",null,s.a.createElement("button",{onClick:function(t){e.onAddComponent(t,"file")}},"Adicionar carregar arquivo"),s.a.createElement(f.b,{to:"/formularios",onClick:this.onSave},s.a.createElement("button",null,"Salvar"))))),s.a.createElement("div",{className:"editor-form"},s.a.createElement("div",null,s.a.createElement("h3",null,"T\xedtulo"),s.a.createElement("input",{onChange:this.onChangeTitle})),s.a.createElement("hr",null),s.a.createElement("div",null,this.state.questions.map((function(t,n){return console.log(t),s.a.createElement(q,{id:t.id,index:n,key:n,onSelect:e.onSelect,onChangeQuestion:e.onChangeQuestion,onChangeComponent:e.onChangeComponent,question:t})})))))}}]),n}(i.Component);L.contextType=E;var x=L,A=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).onChange=a.onChange.bind(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"onChange",value:function(e){var t=this.props.idQuestion,n=e.target.getAttribute("type"),a={idQuestion:t,value:"file"===this.props.component.type?e.target.files[0]:e.target.value,idComponent:e.target.getAttribute("data-id"),titleQuestion:this.props.titleQuestion,type:n};this.props.onChangeAnswer(a)}},{key:"render",value:function(){if(this.props){var e=this.props.component.type,t=this.props.component.text,n=this.props.component.id;return"textarea"===e?s.a.createElement("div",null,s.a.createElement("textarea",{"data-id":n,onChange:this.onChange})):"file"===e||"date"===e?s.a.createElement("div",null,s.a.createElement("input",{"data-id":n,type:e,className:"input-text",onChange:this.onChange,accept:"image/*"})):s.a.createElement("div",null,s.a.createElement("div",{className:"div-left"},s.a.createElement("input",{"data-id":n,value:t,type:e,name:"question"+this.props.idQuestion,onChange:this.onChange})),s.a.createElement("div",{className:"div-right"},s.a.createElement("label",null,t)))}}}]),n}(i.Component),w=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return Object(u.a)(n,[{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("div",{className:"question-text-div"},s.a.createElement("h3",null,this.props.question.title)),s.a.createElement("div",null,this.props.question.components.map((function(t,n){return s.a.createElement(A,{key:n,component:t,onChangeAnswer:e.props.onChangeAnswer,idQuestion:e.props.question.id,titleQuestion:e.props.question.title})}))))}}]),n}(i.Component),N=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={form:{questions:[]},answers:[]},a.loadForm=a.loadForm.bind(Object(d.a)(a)),a.onChangeAnswer=a.onChangeAnswer.bind(Object(d.a)(a)),a.onSend=a.onSend.bind(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"onSend",value:function(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){4===t.readyState&&(200===t.status?(alert("Enviado com sucesso!"),window.location.reload()):alert("Houve algum erro!"))},t.open("post","https://api-meu-formulario.herokuapp.com/answers"),t.setRequestHeader("Content-Type","application/json");var n=this.state.form;n.answers=this.state.answers,t.send(JSON.stringify(n))}},{key:"onChangeAnswer",value:function(e){var t=0,n=e.type,a="radio"!==n,o=[];this.state.answers.map((function(i){a||i.idQuestion!==e.idQuestion?a&&i.idComponent===e.idComponent&&("textarea"===n?i.value+=e.value:i.value=e.value,t+=1):(i.value=e.value,i.idComponent=e.idComponent,i.type=n,i.titleQuestion=e.titleQuestion,t+=1),o.push(i)})),t||(o=this.state.answers).push(e),this.setState({answers:o})}},{key:"loadForm",value:function(){var e=this,t=new XMLHttpRequest;t.addEventListener("load",(function(){var n=JSON.parse(t.responseText);e.setState({form:n})}));var n=document.URL.split("/")[4];t.open("get","https://api-meu-formulario.herokuapp.com/forms/"+n+"?full=true"),t.send()}},{key:"componentDidMount",value:function(){this.loadForm()}},{key:"componentDidUpdate",value:function(){console.log(this.state)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"auto-generated"},this.state.form.questions.map((function(t,n){return s.a.createElement(w,{key:n,question:t,onChangeAnswer:e.onChangeAnswer})}))),s.a.createElement("div",null,s.a.createElement("button",{onClick:this.onSend},"Enviar")))}}]),n}(i.Component),R=function(e){var t=e.children,n=Object(h.a)(e,["children"]),a=s.a.useContext(E);return s.a.createElement(k.b,Object.assign({},n,{render:function(e){var n=e.location;return a.user?t:s.a.createElement(k.a,{to:{pathname:"/",state:{from:n}}})}}))},Q=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={user:null},a.onLogin=a.onLogin.bind(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"onLogin",value:function(e){this.setState({user:e})}},{key:"render",value:function(){return s.a.createElement(f.a,{className:"App"},s.a.createElement("div",{id:"header"},s.a.createElement(f.b,{to:"/formularios"},s.a.createElement("h3",null,"MeuFormul\xe1rio"))),s.a.createElement("hr",null),s.a.createElement(k.d,null,s.a.createElement(R,{path:"/formularios/"},s.a.createElement(y,null)),s.a.createElement(k.b,{path:"/formulario/:link/responder"},s.a.createElement(N,null)),s.a.createElement(R,{path:"/formulario/"},s.a.createElement(x,null)),s.a.createElement(k.b,{path:"/logged"},s.a.createElement(j,null)),s.a.createElement(k.b,{path:""},s.a.createElement(v,{onLogin:this.onLogin}))))}}]),n}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var T=function(e){var t=e.children,n=s.a.useReducer((function(e,t){return Object(a.a)(Object(a.a)({},e),t)}),b),i=Object(o.a)(n,2),r=i[0],l=i[1];return s.a.createElement(E.Provider,{value:r},s.a.createElement(g.Provider,{value:l},t))};l.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(T,null,s.a.createElement(Q,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[26,1,2]]]);
//# sourceMappingURL=main.aab4aebb.chunk.js.map